/**
 * Created by Sam on 18/05/15.
 */
function start(port) {


    console.log("New web socket server, listening on port " + port);

    var express = require('./express');


    var app = express();

    var url = require('url');
    var db = require('./db');

    app.get('/personPass', function (req, res) {

        var personID = req.query.personID;
        var gateID = 1;
        var direction = 'in';
        var query = 'INSERT INTO transaction(personID, gateID, direction) VALUES(' + personID + ',' + gateID + ',\'' + direction+'\')';
        var result = db.attemptQuery(query, function (code) {
            res.status(code).send();
        });


    });

    var server = app.listen(port, function () {

        var host = server.address().address;
        var port = server.address().port;

        console.log('Example app listening at http://%s:%s', host, port);

    });

}


exports.start = start;